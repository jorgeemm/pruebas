{
  "hash": "4e040d51f7e367fffd8b4b6dfd6825c8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tablas de contingencia\"\n---\n\n\n\n\n\n## 1. En R\n\nPermite conocer la relación existente entre variables categóricas. Para ello nos valemos de las tablas de contingencia, donde se muestran las frecuencias de dos variables.\n\n### La función table\n\n1.  Crear la tabla con las dos variables y guardarla:\n\n``` r\ntabla <- table(datos$var1, datos$var2)\n```\n\nEj.:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntabla <- table(datos$situ_lab, datos$hombre)  # (filas, columnas)\ntabla\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   \n                    Mujer Hombre\n  Trabajador/a       7552   9549\n  Pensionista        3515   3854\n  Desempleado/a      1424    846\n  Estudiante          502    617\n  Trabajo doméstico   994     30\n  Otra situación      182    113\n```\n\n\n:::\n:::\n\n\n\n*La primera variable son las filas de la tabla y la segunda las columnas. La variable con menos categorías se pone en las columnas porque así es más sencillo de visualizar e interpretar, creando una tabla que se extiende de forma vertical en lugar de horizontal (mejor la primera tabla que la segunda).*\n\n2.  Crear la tabla de frecuencias:\n\n-   `prop.table(tabla)` Porcentaje de tabla (el % sobre el total)\n-   `prop.table(tabla, 1)` Porcentajes de fila (el 100% lo suman las filas)\n-   `prop.table(tabla, 2)` Porcentajes de columna (el 100% lo suman las columnas) Para leer estas tablas adecuadamente, hay que fijarse si el 100% lo suman las filas, las columnas o toda la tabla.\n\nEj.:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprop.table(tabla)   \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   \n                          Mujer      Hombre\n  Trabajador/a      0.258825142 0.327267119\n  Pensionista       0.120467475 0.132085818\n  Desempleado/a     0.048803893 0.028994448\n  Estudiante        0.017204743 0.021146069\n  Trabajo doméstico 0.034066763 0.001028172\n  Otra situación    0.006237576 0.003872781\n```\n\n\n:::\n:::\n\n\n\nIndica el porcentaje de cada subgrupo sobre el total de la muestra. Por ejemplo, de esta tabla se puede deducir que del total de la población un 25% son mujeres trabajadoras.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprop.table(tabla, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   \n                         Mujer     Hombre\n  Trabajador/a      0.44161160 0.55838840\n  Pensionista       0.47699824 0.52300176\n  Desempleado/a     0.62731278 0.37268722\n  Estudiante        0.44861483 0.55138517\n  Trabajo doméstico 0.97070312 0.02929688\n  Otra situación    0.61694915 0.38305085\n```\n\n\n:::\n:::\n\n\n\nIndica la composición de género de cada una de las situaciones laborales. Por ejemplo, de los trabajadores un 44% son mujeres y un 56% hombres.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprop.table(tabla, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   \n                          Mujer      Hombre\n  Trabajador/a      0.532994566 0.636218269\n  Pensionista       0.248076787 0.256779266\n  Desempleado/a     0.100501094 0.056366180\n  Estudiante        0.035429459 0.041108668\n  Trabajo doméstico 0.070153151 0.001998801\n  Otra situación    0.012844943 0.007528816\n```\n\n\n:::\n:::\n\n\n\nIndica el perfil laboral dentro de cada género. Por ejemplo, un 54% de las mujeres son trabajadoras, mientras que un 63% de los hombres son trabajadores.\n\n### Otras tablas\n\nOtros dos comandos para realizar tablas de contingencia son `xtabls`y `CrossTable`. Estos comandos resultan más útiles cuando, a parte de las frecuencias y los porcentajes, se quieren conocer también otros estadísticos como el Chi^2^ o los residuos.\n\n**Es mejor usar la función `CrossTable`.**\n\n::: {.panel-tabset}\n\n#### `CrossTable()`\n\n``` r\nlibrary(gmodels)\ntabla3 <- CrossTable(datos$var1, datos$var2, #Las variables\n                     digits = 1, #El número de decimales de la tabla\n                     #Otras opciones de la tabla,\n                     format = \"SPSS\") #El formato de salida de la tabla\n```\n\n\n\n\n\n\n\nEj.:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nCrossTable(datos$situ_lab, datos$hombre, digits=1, expected=T, asresid=TRUE, chisq=TRUE, prop.chisq=F, format=\"SPSS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   Cell Contents\n|-------------------------|\n|                   Count |\n|         Expected Values |\n|             Row Percent |\n|          Column Percent |\n|           Total Percent |\n|           Adj Std Resid |\n|-------------------------|\n\nTotal Observations in Table:  29178 \n\n                  | datos$hombre \n   datos$situ_lab |    Mujer  |   Hombre  | Row Total | \n------------------|-----------|-----------|-----------|\n     Trabajador/a |     7552  |     9549  |    17101  | \n                  |   8304.3  |   8796.7  |           | \n                  |     44.2% |     55.8% |     58.6% | \n                  |     53.3% |     63.6% |           | \n                  |     25.9% |     32.7% |           | \n                  |    -17.9  |     17.9  |           | \n------------------|-----------|-----------|-----------|\n      Pensionista |     3515  |     3854  |     7369  | \n                  |   3578.4  |   3790.6  |           | \n                  |     47.7% |     52.3% |     25.3% | \n                  |     24.8% |     25.7% |           | \n                  |     12.0% |     13.2% |           | \n                  |     -1.7  |      1.7  |           | \n------------------|-----------|-----------|-----------|\n    Desempleado/a |     1424  |      846  |     2270  | \n                  |   1102.3  |   1167.7  |           | \n                  |     62.7% |     37.3% |      7.8% | \n                  |     10.1% |      5.6% |           | \n                  |      4.9% |      2.9% |           | \n                  |     14.1  |    -14.1  |           | \n------------------|-----------|-----------|-----------|\n       Estudiante |      502  |      617  |     1119  | \n                  |    543.4  |    575.6  |           | \n                  |     44.9% |     55.1% |      3.8% | \n                  |      3.5% |      4.1% |           | \n                  |      1.7% |      2.1% |           | \n                  |     -2.5  |      2.5  |           | \n------------------|-----------|-----------|-----------|\nTrabajo doméstico |      994  |       30  |     1024  | \n                  |    497.3  |    526.7  |           | \n                  |     97.1% |      2.9% |      3.5% | \n                  |      7.0% |      0.2% |           | \n                  |      3.4% |      0.1% |           | \n                  |     31.6  |    -31.6  |           | \n------------------|-----------|-----------|-----------|\n   Otra situación |      182  |      113  |      295  | \n                  |    143.3  |    151.7  |           | \n                  |     61.7% |     38.3% |      1.0% | \n                  |      1.3% |      0.8% |           | \n                  |      0.6% |      0.4% |           | \n                  |      4.5  |     -4.5  |           | \n------------------|-----------|-----------|-----------|\n     Column Total |    14169  |    15009  |    29178  | \n                  |     48.6% |     51.4% |           | \n------------------|-----------|-----------|-----------|\n\n \nStatistics for All Table Factors\n\n\nPearson's Chi-squared test \n------------------------------------------------------------\nChi^2 =  1308.347     d.f. =  5     p =  9.930323e-281 \n\n\n \n       Minimum expected frequency: 143.2537 \n```\n\n\n:::\n:::\n\n\n\n*Para comprobar qué opciones se pueden aplicar a la tabla, conviene mirar `?(CrossTable)`*\n\nEj. de interpretación de los residuos ajustados: en la celda de mujer y trabajadoras, los residuos ajustados son de -17,9. Esta cifra es inferior a -3,27, por lo que podemos decir que con un nivel de confianza del 99,9% las mujeres se encuentran infrarepresentadas (el símbolo es negativo) dentro del grupo de los trabajadores.\n\n#### `xtabs()`\n\n``` r\ntabla2 <- xtabs(~var1+var2, data = datos) #Crear y guardar la tabla\nftable(tabla2) #Visualizar la tabla\nsummary(tabla2) #Para ver los estadísticos de la tabla (como el chi2 y el p-valor)\n```\n\nEj.:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntabla2 <- xtabs(~situ_lab+hombre, data=datos)\nftable(tabla2) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  hombre Mujer Hombre\nsitu_lab                             \nTrabajador/a              7552   9549\nPensionista               3515   3854\nDesempleado/a             1424    846\nEstudiante                 502    617\nTrabajo doméstico          994     30\nOtra situación             182    113\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(tabla2) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall: xtabs(formula = ~situ_lab + hombre, data = datos)\nNumber of cases in table: 29178 \nNumber of factors: 2 \nTest for independence of all factors:\n\tChisq = 1308.3, df = 5, p-value = 9.93e-281\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n------------------------------------------------------------------------\n\n## 2. Teoría\n\nLas hipótesis a comprobar en una tabla de contingencia son:\n\n-   H~0~= no existe asociación entre las variables (son independientes)\n-   H~1~= sí existe asociación entre las variables\n\nPara saber si existe relación entre las variables debemos fijarnos en:\n\n### El análisis de los residuos\n\nA la hora de examinar la asociación entre variable categóricas es importante diferenciar entre:\n\n-   Frecuencia observada: la frecuencia en la muestra\n-   Frecuencia esperada: la frecuencia que observaríamos en el caso de que **no hubiera relación entre las 2 variables**\n-   Residuo: diferencia entre el valor observado y el esperado, que manifiesta dependencia entre pares de valores cuando es distinto de cero. Cuanto mayor sea el residuo, mayor será la probabilidad de que la muestra provenga de una población en la que las variables estén relacionadas. Para determinar si el valor de los residuos es significativo, es necesario estandarizarlos.\n\nSi el residuo ajustado es mayor (en términos absolutos) que el valor crítico para un determinado nivel de confianza (1,96 para el 95%), se puede decir que la diferencia entre los valores esperados y los ajustados para una celda concreta de la tabla es significativa. En función de si el signo de estos residuos es positivo o negativo, sabremos si la relación establecida en la celda es de sobrerrepresentación dentro de la muestra (signo +) o de infrarrepresentación (signo -). *(Hay un ejemplo de esto al final de la explicación de CrossTables en R)*\n\n### Chi2\n\nEl chi-cuadrado (χ²) es una prueba estadística que se utiliza para comparar frecuencias observadas con frecuencias esperadas, a fin de determinar si hay una diferencia significativa entre ellas. Se emplea comúnmente para analizar tablas de contingencia y evaluar si dos variables categóricas están relacionadas. El𝜒2 se define como:\n\n$$\\chi^2 = \\sum \\frac {(O - E)^2}{E}$$ Donde:\n\n-   O = Frecuencias observadas\n-   E = Frecuencias esperadas\n\nPor ser suma de cuadrados, se cumple que 𝜒2≥0:\n\n-   𝜒2=0 cuando las variables son independientes\n-   𝜒2 crece a medida que aumenta la dependencia entre las variables\n\nSabemos que el valor de chi-cuadrado (χ²) es lo suficientemente alto para ser significativo comparándolo con un valor crítico de una tabla de chi-cuadrado, o mediante su p-valor.\n\n------------------------------------------------------------------------\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}